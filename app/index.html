<!doctype html>
<html lang="">
<head>
    <meta charset="utf-8">
    <link rel="import" href="/elements/elements.html">
    <link rel="stylesheet" href="/styles/style.css">
    <script src="../bower_components/webcomponentsjs/webcomponents.js"></script>
    <link rel="import" href="../bower_components/app-router/app-router.html">
</head>
<body>

<span id="browser-sync-binding"></span>
<template is="dom-bind" id="app">

    <iron-meta type="apigility" key="root-url" value="http://127.0.0.69"></iron-meta>
    <iron-meta type="apigility" key="content-type" value="application/json"></iron-meta>
    <iron-meta type="apigility" key="headers" value='{"Accept": "application/json"}'></iron-meta>
    <apigility-auth
            auth="{{auth}}"
            identity-object="{{identityObject}}"
            oauth-service="oauth"
            identity-object-service="rpc/identity"
            client-id="strapieno-admin" >
    </apigility-auth>

    <template is="dom-if" if="[[!auth]]">
        <div class="layout horizontal center-justified ">
            <div class="layout vertical center-justified ">
                <span>Strapieno login</span>
                <paper-card id="login-box">
                    <div class="card-content">
                        <form is="apigility-auth-form" error-message="{{errorMessage}}">
                            <span>{{errorMessage}}</span>
                            <paper-input name="username" label="User name" ></paper-input>
                            <paper-input type="password" name="password" label="Password" ></paper-input>
                            <input type="submit" value="ok">
                        </form>
                    </div>
                </paper-card>
            </div>
        </div>
    </template>
    <template is="dom-if" if="[[auth]]">
        <paper-scroll-header-panel fixed>
            <paper-toolbar>
                <paper-icon-button icon="menu" on-tap="toggleMenu"></paper-icon-button>
                <div class="flex"></div>
                <strapieno-user-avatar user="{{identityObject}}" height="40" width="40" sizing="cover" placeholder="/images/avatar35x35.png"></strapieno-user-avatar>
            </paper-toolbar>
            <paper-drawer-panel id="paperDrawerPanel" narrow="drawer">
                <paper-scroll-header-panel drawer>
                    <strapieno-menu route="{{route}}" ></strapieno-menu>
                </paper-scroll-header-panel>
                <paper-scroll-header-panel main>
                  <strapieno-router
                    auth="{{auth}}"
                    route="{{route}}"
                    route-params="{{routeParams}}">
                  </strapieno-router>
                </paper-scroll-header-panel>
            </paper-drawer-panel>
        </paper-scroll-header-panel>
    </template>
</template>
<script src="../bower_components/page/page.js"></script>
<script src="/scripts/app.js"></script>
</body>
</html>